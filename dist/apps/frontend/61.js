"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[61],{9032:(w,U,c)=>{c.d(U,{bQ:()=>n,oP:()=>a,G4:()=>d,wi:()=>p,XY:()=>L,jY:()=>$,up:()=>u,h3:()=>S,$1:()=>P,WX:()=>T,qf:()=>z,XJ:()=>le,Wd:()=>m,$M:()=>M});var L={};c.r(L),c.d(L,{addComment$:()=>Q,addCommentSuccess$:()=>B,deleteArticle$:()=>q,deleteArticleSuccess$:()=>_,deleteComment$:()=>J,follow$:()=>N,loadArticle$:()=>V,loadComments$:()=>k,unFollow$:()=>H});var p={};c.r(p),c.d(p,{publishArticle$:()=>ue});var S={};c.r(S),c.d(S,{loadArticles$:()=>me,setListPage$:()=>de,setListTag$:()=>fe});var M={};c.r(M),c.d(M,{favorite$:()=>pe,unFavorite$:()=>ve});var F=c(9604),o=c(5879);let n=(()=>{class e{constructor(t){this.apiService=t}followUser(t){return this.apiService.post("/profiles/"+t+"/follow")}unfollowUser(t){return this.apiService.delete("/profiles/"+t+"/follow")}favorite(t){return this.apiService.post("/articles/"+t+"/favorite")}unfavorite(t){return this.apiService.delete("/articles/"+t+"/favorite")}static#e=this.\u0275fac=function(l){return new(l||e)(o.LFG(F.s))};static#t=this.\u0275prov=o.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var s=c(4221);const u=(0,s.R7)({source:"Article List",events:{setListPage:(0,s.Ky)(),setListConfig:(0,s.Ky)(),loadArticles:(0,s.uZ)(),loadArticlesFailure:(0,s.Ky)(),loadArticlesSuccess:(0,s.Ky)()}}),m=(0,s.R7)({source:"Articles",events:{favorite:(0,s.Ky)(),favoriteFailure:(0,s.Ky)(),favoriteSuccess:(0,s.Ky)(),unfavorite:(0,s.Ky)(),unfavoriteFailure:(0,s.Ky)(),unfavoriteSuccess:(0,s.Ky)()}}),T={listConfig:{type:"ALL",currentPage:1,filters:{limit:10}},articles:{entities:[],articlesCount:0,loaded:!1,loading:!1}},P=(0,s.Tz)({name:"articlesList",reducer:(0,s.Lq)(T,(0,s.on)(u.setListPage,(e,{page:i})=>{const t={...e.listConfig.filters,offset:e?.listConfig?.filters?.limit??1*(i-1)},l={...e.listConfig,currentPage:i,filters:t};return{...e,listConfig:l}}),(0,s.on)(u.setListConfig,(e,{config:i})=>({...e,listConfig:i})),(0,s.on)(u.loadArticles,e=>{const i={...e.articles,loading:!0};return{...e,articles:i}}),(0,s.on)(u.loadArticlesSuccess,(e,i)=>{const t={...e.articles,entities:i.articles,articlesCount:i.articlesCount,loading:!1,loaded:!0};return{...e,articles:t}}),(0,s.on)(u.loadArticlesFailure,(e,i)=>{const t={...e.articles,entities:[],articlesCount:0,loading:!1,loaded:!0};return{...e,articles:t}}),(0,s.on)(m.unfavoriteSuccess,m.favoriteSuccess,(e,{article:i})=>({...e,articles:I(e.articles,i)})))});function I(e,i){const t=e.entities.findIndex(A=>A.slug===i.slug),l=[...e.entities.slice(0,t),Object.assign({},e.entities[t],i),...e.entities.slice(t+1)];return{...e,entities:l,loading:!1,loaded:!0}}const a=(0,s.R7)({source:"Article",events:{loadArticle:(0,s.Ky)(),loadArticleFailure:(0,s.Ky)(),loadArticleSuccess:(0,s.Ky)(),deleteArticle:(0,s.Ky)(),deleteArticleFailure:(0,s.Ky)(),deleteArticleSuccess:(0,s.uZ)(),initializeArticle:(0,s.uZ)(),loadComments:(0,s.Ky)(),loadCommentsFailure:(0,s.Ky)(),loadCommentsSuccess:(0,s.Ky)(),follow:(0,s.Ky)(),followFailure:(0,s.Ky)(),followSuccess:(0,s.Ky)(),unfollow:(0,s.Ky)(),unfollowFailure:(0,s.Ky)(),unfollowSuccess:(0,s.Ky)(),addComment:(0,s.Ky)(),addCommentFailure:(0,s.Ky)(),addCommentSuccess:(0,s.Ky)(),deleteComment:(0,s.Ky)(),deleteCommentFailure:(0,s.Ky)(),deleteCommentSuccess:(0,s.Ky)()}}),d=(0,s.R7)({source:"Article Edit",events:{publishArticle:(0,s.uZ)(),publishArticleSuccess:(0,s.uZ)()}}),h={data:{slug:"",title:"",description:"",body:"",tagList:[],createdAt:"",updatedAt:"",favorited:!1,favoritesCount:0,author:{username:"",bio:"",image:"",following:!1,loading:!1}},comments:[],loaded:!1,loading:!1},$=(0,s.Tz)({name:"article",reducer:(0,s.Lq)(h,(0,s.on)(a.loadArticleSuccess,(e,i)=>({...e,data:i.article,loaded:!0,loading:!1})),(0,s.on)(a.loadArticleFailure,e=>({...e,data:h.data,loaded:!1,loading:!1})),(0,s.on)(a.addCommentSuccess,(e,i)=>{const t=[i.comment,...e.comments];return{...e,comments:t}}),(0,s.on)(a.deleteCommentSuccess,(e,i)=>{const t=e.comments.filter(l=>l.id!==i.commentId);return{...e,comments:t}}),(0,s.on)(a.initializeArticle,d.publishArticleSuccess,a.deleteArticleFailure,e=>h),(0,s.on)(a.loadCommentsSuccess,(e,i)=>({...e,comments:i.comments})),(0,s.on)(a.loadCommentsFailure,e=>({...e,comments:h.comments})),(0,s.on)(a.followSuccess,a.unfollowSuccess,(e,i)=>{const t={...e.data,author:i.profile};return{...e,data:t}}),(0,s.on)(m.favoriteSuccess,m.unfavoriteSuccess,(e,i)=>({...e,data:i.article})))});var r=c(2873),v=c(6328),f=c(7398),g=c(6306),C=c(2096),Y=c(7634),D=c(9397),x=c(9862);let K=(()=>{class e{constructor(t){this.apiService=t}getArticle(t){return this.apiService.get("/articles/"+t)}getComments(t){return this.apiService.get(`/articles/${t}/comments`)}deleteArticle(t){return this.apiService.delete("/articles/"+t)}deleteComment(t,l){return this.apiService.delete(`/articles/${l}/comments/${t}`)}addComment(t,l=""){return this.apiService.post(`/articles/${t}/comments`,{comment:{body:l}})}query(t){return this.apiService.get("/articles"+("FEED"===t.type?"/feed":""),this.toHttpParams(t.filters))}publishArticle(t){return t.slug?this.apiService.put("/articles/"+t.slug,{article:t}):this.apiService.post("/articles/",{article:t})}toHttpParams(t){return Object.getOwnPropertyNames(t).reduce((l,A)=>l.set(A,t[A]),new x.LE)}static#e=this.\u0275fac=function(l){return new(l||e)(o.LFG(F.s))};static#t=this.\u0275prov=o.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var E=c(6484),O=c(4937);const H=(0,r.GW)((e=(0,o.f3M)(r.eX),i=(0,o.f3M)(n))=>e.pipe((0,r.l4)(a.unfollow),(0,v.b)(({username:t})=>i.unfollowUser(t).pipe((0,f.U)(l=>a.unfollowSuccess({profile:l.profile})),(0,g.K)(l=>(0,C.of)(a.unfollowFailure(l)))))),{functional:!0}),N=(0,r.GW)((e=(0,o.f3M)(r.eX),i=(0,o.f3M)(n))=>e.pipe((0,r.l4)(a.follow),(0,v.b)(({username:t})=>i.followUser(t).pipe((0,f.U)(l=>a.followSuccess({profile:l.profile})),(0,g.K)(l=>(0,C.of)(a.followFailure(l)))))),{functional:!0}),J=(0,r.GW)((e=(0,o.f3M)(r.eX),i=(0,o.f3M)(K))=>e.pipe((0,r.l4)(a.deleteComment),(0,v.b)(({commentId:t,slug:l})=>i.deleteComment(t,l).pipe((0,f.U)(A=>a.deleteCommentSuccess({commentId:t})),(0,g.K)(A=>(0,C.of)(a.deleteCommentFailure(A)))))),{functional:!0}),Q=(0,r.GW)((e=(0,o.f3M)(r.eX),i=(0,o.f3M)(K),t=(0,o.f3M)(s.yh))=>e.pipe((0,r.l4)(a.addComment),(0,r.IC)(()=>t.select(E.LH.selectData)),(0,Y.z)(([{slug:l},A])=>i.addComment(l,A.comment).pipe((0,f.U)(y=>a.addCommentSuccess({comment:y.comment})),(0,g.K)(({error:y})=>(0,C.of)(E.i2.setErrors({errors:y.errors})))))),{functional:!0}),B=(0,r.GW)((e=(0,o.f3M)(r.eX))=>e.pipe((0,r.l4)(a.addCommentSuccess),(0,f.U)(()=>E.i2.resetForm())),{functional:!0}),V=(0,r.GW)((e=(0,o.f3M)(r.eX),i=(0,o.f3M)(K))=>e.pipe((0,r.l4)(a.loadArticle),(0,v.b)(t=>i.getArticle(t.slug).pipe((0,f.U)(l=>a.loadArticleSuccess({article:l.article})),(0,g.K)(l=>(0,C.of)(a.loadArticleFailure(l)))))),{functional:!0}),k=(0,r.GW)((e=(0,o.f3M)(r.eX),i=(0,o.f3M)(K))=>e.pipe((0,r.l4)(a.loadComments),(0,v.b)(t=>i.getComments(t.slug).pipe((0,f.U)(l=>a.loadCommentsSuccess({comments:l.comments})),(0,g.K)(l=>(0,C.of)(a.loadCommentsFailure(l)))))),{functional:!0}),q=(0,r.GW)((e=(0,o.f3M)(r.eX),i=(0,o.f3M)(K))=>e.pipe((0,r.l4)(a.deleteArticle),(0,v.b)(t=>i.deleteArticle(t.slug).pipe((0,f.U)(()=>a.deleteArticleSuccess()),(0,g.K)(l=>(0,C.of)(a.deleteArticleFailure(l)))))),{functional:!0}),_=(0,r.GW)((e=(0,o.f3M)(r.eX),i=(0,o.f3M)(O.F0))=>e.pipe((0,r.l4)(a.deleteArticleSuccess),(0,D.b)(()=>i.navigate(["/"]))),{functional:!0,dispatch:!1}),{selectArticleState:ee,selectComments:te,selectData:R,selectLoaded:se,selectLoading:ie}=$,le={selectArticleState:ee,selectComments:te,selectData:R,selectLoaded:se,selectLoading:ie,getAuthorUsername:(0,s.P1)(R,e=>e.author.username)},{selectArticlesListState:oe,selectArticles:X,selectListConfig:Z}=P,ce=(0,s.P1)(X,e=>e.entities),j=(0,s.P1)(X,e=>e.articlesCount),z={selectArticlesListState:oe,selectArticles:X,selectArticleEntities:ce,selectListConfig:Z,selectArticlesCount:j,isLoading:(0,s.P1)(X,e=>e.loading),selectTotalPages:(0,s.P1)(j,Z,(e,i)=>Array.from(new Array(Math.ceil(e/(i?.filters?.limit??1))),(t,l)=>l+1))},ue=(0,r.GW)((e=(0,o.f3M)(r.eX),i=(0,o.f3M)(K),t=(0,o.f3M)(s.yh),l=(0,o.f3M)(O.F0))=>e.pipe((0,r.l4)(d.publishArticle),(0,r.IC)(()=>t.select(E.LH.selectData)),(0,v.b)(([A,y])=>i.publishArticle(y).pipe((0,D.b)(G=>l.navigate(["article",G.article.slug])),(0,f.U)(()=>d.publishArticleSuccess()),(0,g.K)(G=>(0,C.of)(E.i2.setErrors({errors:G.error.errors})))))),{functional:!0}),de=(0,r.GW)((e=(0,o.f3M)(r.eX))=>e.pipe((0,r.l4)(u.setListPage),(0,f.U)(()=>u.loadArticles())),{functional:!0}),fe=(0,r.GW)((e=(0,o.f3M)(r.eX))=>e.pipe((0,r.l4)(u.setListConfig),(0,f.U)(()=>u.loadArticles())),{functional:!0}),me=(0,r.GW)((e=(0,o.f3M)(r.eX),i=(0,o.f3M)(s.yh),t=(0,o.f3M)(K))=>e.pipe((0,r.l4)(u.loadArticles),(0,r.IC)(()=>i.select(z.selectListConfig)),(0,v.b)(([l,A])=>t.query(A).pipe((0,f.U)(y=>u.loadArticlesSuccess({articles:y.articles,articlesCount:y.articlesCount})),(0,g.K)(y=>(0,C.of)(u.loadArticlesFailure({error:y})))))),{functional:!0}),pe=(0,r.GW)((e=(0,o.f3M)(r.eX),i=(0,o.f3M)(n))=>e.pipe((0,r.l4)(m.favorite),(0,v.b)(({slug:t})=>i.favorite(t).pipe((0,f.U)(l=>m.favoriteSuccess({article:l.article})),(0,g.K)(l=>(0,C.of)(m.favoriteFailure(l)))))),{functional:!0}),ve=(0,r.GW)((e=(0,o.f3M)(r.eX),i=(0,o.f3M)(n))=>e.pipe((0,r.l4)(m.unfavorite),(0,v.b)(({slug:t})=>i.unfavorite(t).pipe((0,f.U)(l=>m.unfavoriteSuccess({article:l.article})),(0,g.K)(l=>(0,C.of)(m.unfavoriteFailure(l)))))),{functional:!0})},7061:(w,U,c)=>{c.r(U),c.d(U,{ARTICLE_EDIT_ROUTES:()=>I,ArticleEditComponent:()=>u});var L=c(7582),p=c(6484),S=c(95),M=c(8791),F=c(4221),o=c(9032),n=c(5879);const s=[{type:"INPUT",name:"title",placeholder:"Article Title",validator:[S.kI.required]},{type:"INPUT",name:"description",placeholder:"What's this article about?",validator:[S.kI.required]},{type:"TEXTAREA",name:"body",placeholder:"Write your article (in markdown)",validator:[S.kI.required]},{type:"INPUT",name:"tagList",placeholder:"Enter Tags",validator:[]}];let u=class W{constructor(d){this.store=d,this.structure$=this.store.select(p.LH.selectStructure),this.data$=this.store.select(p.LH.selectData)}ngOnInit(){this.store.dispatch(p.i2.setStructure({structure:s})),this.store.select(o.XJ.selectData).pipe((0,M.t)(this)).subscribe(d=>this.store.dispatch(p.i2.setData({data:d})))}updateForm(d){this.store.dispatch(p.i2.updateData({data:d}))}submit(){this.store.dispatch(o.G4.publishArticle())}ngOnDestroy(){this.store.dispatch(p.i2.initializeForm())}static#e=this.\u0275fac=function(h){return new(h||W)(n.Y36(F.yh))};static#t=this.\u0275cmp=n.Xpm({type:W,selectors:[["cdt-article-edit"]],standalone:!0,features:[n.jDz],decls:8,vars:2,consts:[[1,"editor-page"],[1,"container","page"],[1,"row"],[1,"col-md-10","offset-md-1","col-xs-12"],[3,"data$","structure$","updateForm"],["type","button",1,"btn","btn-lg","pull-xs-right","btn-primary",3,"click"]],template:function(h,$){1&h&&(n.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),n._UZ(4,"cdt-list-errors"),n.TgZ(5,"cdt-dynamic-form",4),n.NdJ("updateForm",function(v){return $.updateForm(v)}),n.qZA(),n.TgZ(6,"button",5),n.NdJ("click",function(){return $.submit()}),n._uU(7,"Publish Article"),n.qZA()()()()()),2&h&&(n.xp6(5),n.Q6J("data$",$.data$)("structure$",$.structure$))},dependencies:[p.rm,p.St],changeDetection:0})};u=(0,L.gn)([(0,M.c)(),(0,L.w6)("design:paramtypes",[F.yh])],u);var m=c(2873),b=c(359),T=c(2096);const I=[{path:"",component:u,providers:[(0,F.oY)(o.jY),(0,m.y3)(o.wi)],children:[{path:"",pathMatch:"full",component:u,canActivate:[b.p2]},{path:":slug",component:u,resolve:{articleEditResolver:a=>{const d=a.params.slug,h=(0,n.f3M)(F.yh);return d&&h.dispatch(o.oP.loadArticle({slug:d})),(0,T.of)(!0)}}}]}]}}]);